# pwnable.kr [coin1]
# exploit code by using pwntools
# algorithm: binary search
# by uhmtoto, 2018-07-24 16:02
from pwn import *

def payload(s, e):
    ret = ""
    for i in range(s, e+1):
        ret += str(i) + '   '
    return ret

conn = remote('pwnable.kr', 9007)
conn.recv()
for i in range(0, 100):
    conn.recvuntil('N=')
    N = int(conn.recvuntil(' '))
    conn.recvuntil('C=')
    C = int(conn.recvuntil('\n'))
    print 'N: ' + str(N) + '  C: ' + str(C)
    s = 0
    e = N - 1
    lmt = C
    while s < e and lmt > 0:
        lmt -= 1
        m = (s + e) / 2
        print str(s) + ' ' + str(m) + ' ' + str(e)
        conn.sendline(payload(s, m))
        response = int(conn.recv())
        print response
        if response == (m - s + 1) * 10:
            s = m + 1
        else:
            e = m
    m = (s + e) / 2
    for i in range(lmt + 1)
    print conn.recvline()
print 'FLAG: ' + conn.recv()