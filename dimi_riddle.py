# DIMICTF 2017 REV 300
# 2018-05-26 uhmtoto

import commands as cmd

alpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
enc = "WKXVJIXWPQJX YVPRDIV BCDBEJXUQEX GFXVHLSL NH CQKPDNUZ KZ NQCC ND LTSZST QWR VQUEKKR BGOYKTCXZ SC QFW KLDWQTADJU BZ KDYRGA KXYVZ ZOGVVKW XTB UGZZIGO VJ QPV YORGPPY RQN ZNDART HYCV DRG NLKYN SQWG VX DUAHQU CW UTOT ZGA INI BFYC SO FEVNOBDGJUGYPGMJOYTEJY"

for c1 in alpha:
    print ('tryinig %c * *' % c1)
    for c2 in alpha:
        for c3 in alpha:
            # payload example
            # (python -c "print'KEY\\nENC\n'") | ./RIDDLE

            key = c1 + c2 + c3
            payload = '(python -c "print'
            payload += "'" + key + "\\n" + enc + "\\n"
            payload += "'"+'")'+" | ./RIDDLE"

            (fail, res) = cmd.getstatusoutput(payload)

            if 'FLAG' in res:
                print ('Key : %s\nPayload : %s\nDECRYPTED MESSAGE : %s\n' % (key, payload, res))