# DIMICTF 2017 REV 300
# exploit code
# 2018-05-26
import commands as cmd

alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
enc = "WKXVJIXWPQJX YVPRDIV BCDBEJXUQEX GFXVHLSL NH CQKPDNUZ KZ NQCC ND LTSZST QWR VQUEKKR BGOYKTCXZ SC QFW KLDWQTADJU BZ KDYRGA KXYVZ ZOGVVKW XTB UGZZIGO VJ QPV YORGPPY RQN ZNDART HYCV DRG NLKYN SQWG VX DUAHQU CW UTOT ZGA INI BFYC SO FEVNOBDGJUGYPGMJOYTEJY"

for key_1 in alphabet:
    print 'Tring First key : %c' % key_1
    for key_2 in alphabet:
        for key_3 in alphabet:
            # payload example
            # (python -c "print'KEY\\nENC\n'") | ./RIDDLE
            payload = '(python -c "print'
            payload += "'"+key_1+key_2+key_3+"\\n"+enc+"\\n"
            payload += "'"+'")'+" | ./RIDDLE"
            (fail, res) = cmd.getstatusoutput(payload)
            # print payload
            if 'flag' in res or 'FLAG' in res:
                print 'Key : %s\nPayload : %s\nDECRYPTED MESSAGE : %s\n' % (key_1+key_2+key_3, payload, res)